holygpu8a11202:0 err: [W socket.cpp:464] [c10d] The server socket cannot be initialized on [::]:40015 (errno: 97 - Address family not supported by protocol).
holygpu8a11202:0 err: [W socket.cpp:697] [c10d] The client socket cannot be initialized to connect to [holygpu8a11202.rc.fas.harvard.edu]:40015 (errno: 97 - Address family not supported by protocol).
holygpu8a11202:0 out: 2024-11-14 20:36:04.073	holygpu8a11202.rc.fas.harvard.edu:0	train:330	INFO	multiprocessing start method set to 'spawn'
holygpu8a11202:0 out: 2024-11-14 20:36:06.101	holygpu8a11202.rc.fas.harvard.edu:0	train:161	INFO	Configuration:
holygpu8a11202:0 out: 2024-11-14 20:36:06.101	holygpu8a11202.rc.fas.harvard.edu:0	train:162	INFO	TrainConfig(just_score_model=False, tau=None, data_start_step=None, sft_dataset=None, load_checkpoint_type=None, run_name='olmo_57672926_1', seed=1, epoch=None, dry_run=False, model=ModelConfig(d_model=2048, n_heads=32, n_kv_heads=None, clip_qkv=None, n_layers=24, mlp_ratio=4, mlp_hidden_size=8192, activation_type='gelu', block_type='sequential', block_group_size=1, alibi=False, alibi_bias_max=8.0, rope=True, rope_full_precision=True, flash_attention=False, attention_dropout=0.0, multi_query_attention=False, attention_layer_norm=True, residual_dropout=0.0, embedding_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, attention_layer_norm_with_affine=True, max_sequence_length=512, include_bias=False, bias_for_layer_norm=False, scale_logits=False, vocab_size=50280, embedding_size=50304, weight_tying=False, eos_token_id=0, pad_token_id=1, init_device='meta', init_fn='mitchell', init_std=0.02, init_cutoff_factor=None, precision='amp_bf16'), optimizer=OptimizerConfig(name='adamw', learning_rate=0.001, weight_decay=0.0, betas=(0.9, 0.95), eps=1e-15, no_decay_norm_and_bias=None, decay_norm_and_bias=False, decay_embeddings=False, metrics_log_interval=100), scheduler=SchedulerConfig(name='cosine_with_warmup', units='steps', t_warmup=8000, t_max=None, alpha_f=0.1, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=None), data=DataConfig(paths='c4', datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=16, drop_last=True, pin_memory=True, prefetch_factor=16, persistent_workers=True, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path='c4-down-tau=64'), restore_dataloader=True, fast_forward_batches=None, evaluators=[EvaluatorConfig(label='books', type='lm', data=DataConfig(paths=None, datasets={'books_val': 'books-val'}, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=True, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=None, sft_use_label=False, sft=False), EvaluatorConfig(label='piqa_train', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=None, sft_use_label=False, sft=False), EvaluatorConfig(label='openbook_qa_train', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=None, sft_use_label=False, sft=False), EvaluatorConfig(label='hellaswag_train', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=None, sft_use_label=False, sft=False), EvaluatorConfig(label='winogrande_train', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=None, sft_use_label=False, sft=False), EvaluatorConfig(label='arc_easy_train', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=None, sft_use_label=False, sft=False), EvaluatorConfig(label='arc_challenge_train', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=None, sft_use_label=False, sft=False), EvaluatorConfig(label='boolq_train', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=None, sft_use_label=False, sft=False), EvaluatorConfig(label='sciq_train', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=None, sft_use_label=False, sft=False), EvaluatorConfig(label='piqa_test', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=1000, sft_use_label=False, sft=False), EvaluatorConfig(label='openbook_qa_test', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=1000, sft_use_label=False, sft=False), EvaluatorConfig(label='hellaswag_test', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=1000, sft_use_label=False, sft=False), EvaluatorConfig(label='winogrande_test', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=1000, sft_use_label=False, sft=False), EvaluatorConfig(label='arc_easy_test', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=1000, sft_use_label=False, sft=False), EvaluatorConfig(label='arc_challenge_test', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=1000, sft_use_label=False, sft=False), EvaluatorConfig(label='boolq_test', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=1000, sft_use_label=False, sft=False), EvaluatorConfig(label='sciq_test', type='downstream', data=DataConfig(paths=None, datasets=None, label_mask_paths=None, pad_direction='right', generate_attention_mask=False, num_workers=0, drop_last=False, pin_memory=False, prefetch_factor=None, persistent_workers=False, timeout=0, seed=None, memmap_dtype='uint16', extra_data_paths=None, extra_data_key=None, load_extra_data_to_ram=False, index_path=None), device_eval_batch_size=None, subset_num_batches=1000, sft_use_label=False, sft=False)], eval_interval=2000, tokenizer=TokenizerConfig(identifier='allenai/eleuther-ai-gpt-neox-20b-pii-special', truncate_direction='right'), save_folder='ckpts/57672926_1/', remote_save_folder=None, canceled_check_interval=50, save_interval=5000, save_interval_unsharded=100000, save_interval_ephemeral=None, save_num_checkpoints_to_keep=1, save_num_unsharded_checkpoints_to_keep=1, save_overwrite=True, force_save_unsharded=False, no_pre_train_checkpoint=False, load_path=None, load_path_sharded_checkpointer=None, reset_optimizer_state=False, reset_trainer_state=False, sharded_checkpointer='torch_legacy', new_style_checkpoints=None, max_duration=192000, global_train_batch_size=256, device_train_batch_size=256, device_train_microbatch_size=32, device_eval_batch_size=64, eval_subset_num_batches=100, eval_on_load=False, device_train_grad_accum=8, max_grad_norm=1.0, max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, speed_monitor=SpeedMonitorConfig(window_size=1, gpu_flops_available=None), console_log_interval=10, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, backend='inductor'), fsdp=FSDPConfig(use_orig_params=True, sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, wrapping_strategy=None, precision='mixed', hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, time_limit=2100000.0, extra_steps_after_cancel=10, early_stopping_factor=None, save_data_indices=True, python_profiling=False, torch_profiling=False, stop_at=None, stop_after=None, activation_checkpointing=None, fused_loss=None)
holygpu8a11202:0 out: 2024-11-14 20:36:06.106	holygpu8a11202.rc.fas.harvard.edu:0	train:169	INFO	Saving config to ckpts/57672926_1/config.yaml
holygpu8a11202:0 out: 2024-11-14 20:36:06.197	holygpu8a11202.rc.fas.harvard.edu:0	train:197	INFO	Using fixed index path: c4-down-tau=64
holygpu8a11202:0 out: 2024-11-14 20:36:17.897	holygpu8a11202.rc.fas.harvard.edu:0	olmo.util:160	CRITICAL	Uncaught FileNotFoundError: [Errno 2] No such file or directory: '/n/holyscratch01/sham_lab/dclm/color_filter/indices/c4-down-tau=64/selected_indices.npy'
holygpu8a11202:0 out: Traceback (most recent call last):
holygpu8a11202:0 out:   File "/n/home11/cbrownpinilla/color_filter/color-filter-olmo/scripts/train.py", line 338, in <module>
holygpu8a11202:0 out:     main(cfg)
holygpu8a11202:0 out:   File "/n/home11/cbrownpinilla/color_filter/color-filter-olmo/scripts/train.py", line 199, in main
holygpu8a11202:0 out:     train_loader = build_train_dataloader_fixed_index(cfg)
holygpu8a11202:0 out:   File "/n/home11/cbrownpinilla/color_filter/color-filter-olmo/olmo/data/__init__.py", line 154, in build_train_dataloader_fixed_index
holygpu8a11202:0 out:     IterableDatasetFixedIndex(
holygpu8a11202:0 out:   File "/n/home11/cbrownpinilla/color_filter/color-filter-olmo/olmo/data/iterable_dataset.py", line 227, in __init__
holygpu8a11202:0 out:     self.indices = np.memmap(input_index_path, mode="r", dtype=np.uint32)
holygpu8a11202:0 out:   File "/n/home11/cbrownpinilla/.local/lib/python3.10/site-packages/numpy/core/memmap.py", line 229, in __new__
holygpu8a11202:0 out:     f_ctx = open(os_fspath(filename), ('r' if mode == 'c' else mode)+'b')
holygpu8a11202:0 out: FileNotFoundError: [Errno 2] No such file or directory: '/n/holyscratch01/sham_lab/dclm/color_filter/indices/c4-down-tau=64/selected_indices.npy'
srun: error: holygpu8a11202: task 0: Exited with exit code 1
srun: Terminating StepId=57672926.0
